---
title: "Data Visualization Supplement Penn State R Bootcamp 2019"
author: "Holly Zaharchuk, Rebecca Janis & Alicia Vallorani"
date: "`r Sys.time()`"
output:
  html_document:
    code_foldering: show
    mathjax: default
    theme: spacelab
    toc: yes
    toc_depth: 3
    toc_float: yes
    code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# handy package manager that installs and loads packages used in this document
if (!("pacman" %in% installed.packages()[,"Package"])) { install.packages("pacman") } 
pacman::p_load(tidyverse, psych, interactions) # install (if needed) and load packages
```


In the previous scatter plot, the individual points for our 700 subjects were overlapping. We can add jitter to the points (i.e., slightly vary the location of the points) to handle this overplotting issue.
```{r}
# Scatter plot with jitter
ggplot(sat.act, aes(age, ACT, color=education)) +
  geom_point(position="jitter") +
  ylab("Score") +
  xlab("Age") +
  labs(color="Education level") +
  ggtitle("ACT scores by age and education level") +
  theme_classic()

# Scatter plot with jitter short-cut
ggplot(sat.act, aes(age, ACT, color=education)) +
  geom_jitter() +
  ylab("Score") +
  xlab("Age") +
  labs(color="Education level") +
  ggtitle("ACT scores by age and education level") +
  theme_classic()
```


You can see that ggplot() is treating education like a continuous variable, since the values are entered as integers in the dataset. We should convert these values to factors, so that ggplot() knows that we're treating them as categories.

```{r}
# Michael, I would probably do this a very different way like with an ifelse as.factor statement. Should a revise or leave as is? - Alicia
  ## have it but don't go over it

# Get education levels
edu_list <- sat.act %>%
  pull(education) %>%
  unique() %>%
  sort() %>%
  c()

# Get gender levels
gender_list <- sat.act %>%
  pull(gender) %>%
  unique() %>%
  sort() %>%
  c()

# Relabel gender levels
gender_label <- c("Men", "Women")

# Create factors
sat.act <- sat.act %>%
  mutate(education_factor=factor(education,
                                 levels=edu_list,
                                 labels=edu_list),
         gender_factor=factor(gender,
                              levels=gender_list,
                              labels=gender_label))
```

You'll also notice that the bars didn't align with the origin on the previous two graphs. We can fix this by using the expand argument in scale_y_continuous(). There are many different versions of this function that are useful for adjusting the axes on your plots.

```{r}
# Bar graph with expanded y axis and factors
ggplot(sat.act, aes(education_factor, ACT)) +
  geom_bar(stat="summary", fun.y="mean") +
  ylab("Average score") +
  xlab("Education level") +
  ggtitle("Average ACT scores at each education level") +
  scale_y_continuous(expand=c(0,0)) +
  theme_classic()
```


Finally, we can add more information to this graph by including gender information. One way to do this is to include gender as a fill for the bars.

```{r}
# Bar graph with additional element stacked
ggplot(sat.act, aes(education_factor, ACT, fill=gender_factor)) +
  geom_bar(stat="summary", fun.y="mean") +
  scale_fill_grey() +
  ylab("Average score") +
  xlab("Education level") +
  labs(fill="Gender") +
  ggtitle("Average ACT scores at each education level by gender") +
  scale_y_continuous(expand=c(0,0)) +
  theme_classic()

# Bar graph with additional element dodged
ggplot(sat.act, aes(education_factor, ACT, fill=gender_factor)) +
  geom_bar(stat="summary", fun.y="mean", position="dodge") +
  scale_fill_grey() +
  ylab("Average score") +
  xlab("Education level") +
  labs(fill="Gender") +
  ggtitle("Average ACT scores at each education level by gender") +
  scale_y_continuous(expand=c(0,0)) +
  theme_classic()
```

Instead of plotting the bars side-by-side, we can use facet_wrap() to create separate graphs for each gender. It's also possible to set the limits on the axes manually, so the bars don't run into the labels.

```{r}
# Bar graph with additional element stacked
ggplot(sat.act, aes(education_factor, ACT, fill=gender_factor)) +
  geom_bar(stat="summary", fun.y="mean") +
  facet_wrap(~gender_factor) +
  scale_fill_grey() +
  ylab("Average score") +
  xlab("Education level") +
  labs(fill="Gender") +
  ggtitle("Average ACT scores at each education level by gender") +
  scale_y_continuous(expand=c(0,0), limits=c(0,36)) +
  theme_classic()
```
